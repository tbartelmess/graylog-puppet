#! /bin/sh

DOWNLOAD_URL=<%= scope['graylog::server::webinterface_download_url'] %>
DOWNLOAD_FILE="graylog2-web-interface-<%= scope['graylog::server::version'] %>.tgz"
TEMPDIR=/tmp
ARCHIVE_FOLDER="$TEMPDIR/graylog2-web-interface-<%= scope['graylog::server::version'] %>"
VERSION=<%= scope['graylog::server::version'] %>
TARGET_FOLDER=<%= scope['graylog::server::web_interface_install_location'] %>

# Downloading the file
cd $TEMPDIR

rm -rf $DOWNLOAD_FILE
curl -L $DOWNLOAD_URL -o $DOWNLOAD_FILE
rm -rf $ARCHIVE_FOLDER
tar xfvz $DOWNLOAD_FILE
rm -rf $JARFILE
mv $ARCHIVE_FOLDER $TARGET_FOLDER
echo "$VERSION" > $TARGET_FOLDER/version
